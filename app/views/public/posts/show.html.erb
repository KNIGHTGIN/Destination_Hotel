<h1>投稿詳細</h1>

<label>ホテル名</label>
<p><%= @post.hotel_name %></p>

<label>投稿画像</label>
<% @post.post_images.each do |post_image| %>
  <%= attachment_image_tag post_image, :image, size: "130x130" %>
<% end %>

<label>本文</label>
<p><%= @post.text %></p>

<label>投稿ユーザー</label>
<p><%= link_to @post.user.name,users_index_path %></p>

<label>タグ</label>
<% @post_tags.each do |tag| %>
  <%= link_to tag.name,search_tag_path(tag_id: tag.id)%><%="(#{tag.posts.count})" %>
<% end %>

<label>いいね件数: <%= @post.likes.count %></label>
<lavel>コメント件数: <%= @post.comments.count %></lavel>
<% if current_user.already_liked?(@post) %>
  <%= button_to 'いいねを取り消す', post_like_path(@post), method: :delete %>
<% else %>
  <%= button_to 'いいね', post_likes_path(@post) %>
<% end %>
<h2>いいねしたユーザー</h2>
<% @post.liked_users.each do |user| %>
  <li><%= user.email %></li>
<% end %>

<label>コメント</label>
<%= @post.body %>

<%= form_with(model:[@post, @comment], method: :post) do |f| %>
  <%= f.text_area :body %>
  <%= f.hidden_field :post_id, value: @post.id %>
  <%= f.submit 'コメントする' %>
<% end %>

<% @comments.each do |comment| %>
<tr>
  <td><%= comment.user.name %></td>
  <td><%= comment.body %></td>
  <td>(<%= comment.created_at.strftime('%Y/%m/%d') %>)</td>
  <td>
    <% if comment.user == current_user %>
      <%=link_to "削除", comment_path(comment.id), method: :delete %>
    <% end %>
  </td>
</tr>
<% end %>

<%= link_to edit_post_path(@post), class: "btn btn-block bgleft " do %>
<span><i class="fas fa-cog"></i> 編集する</span>
<% end %>

　<div>
　  <%= link_to "投稿一覧に戻る", posts_path %>
　</div>